/*!
 * @form-create/core v0.0.5
 * (c) 2018-2019 xaboy
 * Github https://github.com/xaboy/form-create
 * Released under the MIT License.
 */
import _mergeJSXProps from"@vue/babel-helper-vue-jsx-merge-props";import Vue from"vue";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function $set(e,t,r){Vue.set(e,t,r)}function $del(e,t){Vue.delete(e,t)}function isValidChildren(e){return Array.isArray(e)&&e.length>0}var _toString=Object.prototype.toString;function isUndef(e){return null==e}function toString(e){return null==e?"":"object"===_typeof(e)?JSON.stringify(e,null,2):String(e)}function extend(e,t){for(var r in t)$set(e,r,t[r]);return e}function debounce(e,t){var r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];null!==r&&clearTimeout(r),r=setTimeout(function(){return e.apply(void 0,i)},t)}}function isType(e,t){return _toString.call(e)==="[object "+t+"]"}function isPlainObject(e){return isType(e,"Object")}function isFunction(e){return isType(e,"Function")}function isString(e){return isType(e,"String")}function isBool(e){return isType(e,"Boolean")}function toLine(e){var t=e.replace(/([A-Z])/g,"-$1").toLowerCase();return 0===t.indexOf("-")&&(t=t.substr(1)),t}function toArray(e){return Array.isArray(e)?e:isUndef(e)||""===e?[]:[e]}function isElement(e){return"object"===_typeof(e)&&null!==e&&1===e.nodeType&&!isPlainObject(e)}function deepExtend(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!1;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];if((r=Array.isArray(i))||isPlainObject(i)){var a=void 0===e[n];r?(r=!1,a&&$set(e,n,[])):a&&$set(e,n,{}),deepExtend(e[n],i)}else $set(e,n,i)}return e}var id=0;function uniqueId(){return++id}function errMsg(e){return"\ngithub:https://github.com/xaboy/form-create\ndocument:http://www.form-create.com"+(e||"")}var formCreateName="FormCreate";function $FormCreate(e,t){return{name:formCreateName,props:{rule:{type:Array,required:!0,default:function(){return{}}},option:{type:Object,default:function(){return{}},required:!1},value:Object},data:function(){return{formData:void 0,buttonProps:void 0,resetProps:void 0,$f:void 0,isShow:!0,unique:1}},components:t,render:function(){return this.formCreate.render()},methods:{_buttonProps:function(e){this.$set(this,"buttonProps",deepExtend(this.buttonProps,e))},_resetProps:function(e){this.$set(this,"resetProps",deepExtend(this.resetProps,e))},_refresh:function(){this.unique+=1}},watch:{option:"_refresh",rule:function(e){this.formCreate.handle.reloadRule(e)}},beforeCreate:function(){var t=this.$options.propsData,r=t.rule,n=t.option;this.formCreate=new e(r,n),this.formCreate.beforeCreate(this)},created:function(){this.formCreate.created(),this.$f=this.formCreate.api(),this.$emit("input",this.$f)},mounted:function(){this.formCreate.mounted(),this.$emit("input",this.$f)},beforeDestroy:function(){this.formCreate.handle.reloadRule([]),this.formCreate.handle.$render.clearCacheAll()}}}function defVData(){return{class:{},style:{},attrs:{},props:{},domProps:{},on:{},nativeOn:{},directives:[],scopedSlots:{},slot:void 0,key:void 0,ref:void 0}}var VData=function(){function e(){_classCallCheck(this,e),this.init()}return _createClass(e,[{key:"class",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return isUndef(e)?this:(Array.isArray(e)?e.forEach(function(e){$set(t._data.class,toString(e),!0)}):isPlainObject(e)?$set(this._data,"class",extend(this._data.class,e)):$set(this._data.class,toString(e),void 0===r||r),this)}},{key:"directives",value:function(e){return isUndef(e)?this:($set(this._data,"directives",this._data.directives.concat(toArray(e))),this)}},{key:"init",value:function(){return this._data=defVData(),this}},{key:"get",value:function(){var e=this,t=Object.keys(this._data).reduce(function(t,r){var n=e._data[r];return void 0===n?t:Array.isArray(n)&&!n.length?t:Object.keys(n).length||"props"===r?(t[r]=n,t):t},{});return this.init(),t}}]),e}(),keyList=["ref","key","slot"],objList=["scopedSlots","nativeOn","on","domProps","props","attrs","style"];function baseRule(){return{validate:[],options:[],col:{},children:[],emit:[],template:void 0,emitPrefix:void 0,native:void 0,info:void 0}}function creatorFactory(e){return function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Creator(e,t,r,n,i)}}function creatorTypeFactory(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"type";return function(n,i,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=new Creator(e,n,i,a,o);return isFunction(t)?t(s):s.props(r,t),s}}keyList.forEach(function(e){VData.prototype[e]=function(t){return $set(this._data,e,t),this}}),objList.forEach(function(e){VData.prototype[e]=function(t,r){return isUndef(t)?this:(isPlainObject(t)?$set(this._data,e,extend(this._data[e],t)):$set(this._data[e],toString(t),r),this)}});var Creator=function(e){function t(e,r,n,i){var a,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return _classCallCheck(this,t),extend((a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._data,baseRule()),extend(a._data,{type:e,title:r,field:n,value:i}),isPlainObject(o)&&a.props(o),a}return _inherits(t,VData),_createClass(t,[{key:"type",value:function(e){return this.props("type",e),this}},{key:"getRule",value:function(){return this._data}},{key:"event",value:function(){return this.on.apply(this,arguments),this}}]),t}(),keyAttrs=["emitPrefix","className","value","name","title","native","info"];keyAttrs.forEach(function(e){Creator.prototype[e]=function(t){return $set(this._data,e,t),this}});var objAttrs=["col"];objAttrs.forEach(function(e){Creator.prototype[e]=function(t){return $set(this._data,e,extend(this._data[e],t)),this}});var arrAttrs=["validate","options","children","emit"];function toJson(e){return JSON.stringify(e,function(e,t){if(t instanceof Creator)return t.getRule();if(!t||!0!==t._isVue){if("function"!=typeof t)return t;if(t.__inject&&(t=t.__origin),!t.__emit)return t}})}function parseJson(json){return JSON.parse(json,function(k,v){return v.indexOf&&v.indexOf("function")>-1?eval("(function(){return "+v+" })()"):v})}function makerFactory(){var e={},t=creatorFactory("");return extend(e,{create:function(e,r,n){var i=t("",r);return i._data.type=e,i._data.title=n,i},createTmp:function(e,r,n,i){var a=t("",n);return a._data.type="template",a._data.template=e,a._data.title=i,a._data.vm=r,a}}),e.template=e.createTmp,e.parse=parse,e}function parse(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(isString(e)&&(e=parseJson(e)),e instanceof Creator)return t?e:e.getRule();if(isPlainObject(e)){var r=ruleToMaker(e);return t?r:r.getRule()}if(Array.isArray(e)){var n=e.map(function(e){return parse(e,t)});return Object.defineProperty(n,"find",{value:findField,enumerable:!1,configurable:!1}),n}return e}function findField(e){var t=[];for(var r in this){var n=this[r]instanceof Creator?this[r].rule:this[r];if(n.field===e)return this[r];isValidChildren(n.children)&&(t=t.concat(n.children))}if(t.length>0)return findField.call(t,e)}function ruleToMaker(e){var t=new Creator;return Object.keys(e).forEach(function(r){t._data[r]=e[r]}),t}function parseVData(e){return isString(e)?e={domProps:{innerHTML:e}}:e&&isFunction(e.get)&&(e=e.get()),e}function getVNode(e){return isFunction(e)?e():e||[]}arrAttrs.forEach(function(e){Creator.prototype[e]=function(t){return Array.isArray(t)||(t=[t]),$set(this._data,e,this._data[e].concat(t)),this}});var VNode=function(){function e(t){_classCallCheck(this,e),t&&this.setVm(t)}return _createClass(e,[{key:"setVm",value:function(e){this.vm=e,this.$h=e.$createElement}},{key:"make",value:function(e,t,r){var n=this.$h(e,parseVData(t),getVNode(r));return n.context=this.vm,n}}],[{key:"use",value:function(t){Object.keys(t).forEach(function(r){e.prototype[toString(r).toLocaleLowerCase()]=e.prototype[r]=function(e,n){return this.make(t[r],e,n)}})}}]),e}(),BaseParser=function(){function e(t,r,n){_classCallCheck(this,e),this.rule=r,this.vData=new VData,this.vNode=new VNode,this.id=n,this.watch=[],this.type=toString(r.type).toLocaleLowerCase(),this.isDef=!0,this.el=void 0,r.field?this.field=r.field:(this.field="_def_"+uniqueId(),this.isDef=!1),this.name=r.name,this.unique="fc_"+n,this.key="key_"+n,this.refName="__"+this.field+this.id,this.formItemRefName="fi"+this.refName,this.update(t),this.init()}return _createClass(e,[{key:"update",value:function(e){this.$handle=e,this.$render=e.$render,this.vm=e.vm,this.options=e.options,this.vNode.setVm(this.vm),this.deleted=!1}},{key:"init",value:function(){}},{key:"toFormValue",value:function(e){return e}},{key:"toValue",value:function(e){return e}}]),e}(),$de=debounce(function(e){return e()},1),Render=function(){function e(t){_classCallCheck(this,e),this.$handle=t,this.fc=t.fc,this.vm=t.vm,this.options=t.options,this.$form=t.$form,this.vNode=new VNode(this.vm),this.vData=new VData,this.cache={},this.renderList={}}return _createClass(e,[{key:"clearCache",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.cache[e.id]){this.cacheStatus(e)&&this.$handle.refresh();var r=this.cache[e.id].parent;this.cache[e.id]=null,r&&t&&this.clearCache(r,t)}}},{key:"clearCacheAll",value:function(){this.cache={}}},{key:"setCache",value:function(e,t,r){this.cache[e.id]={vnode:t,use:!1,parent:r}}},{key:"cacheStatus",value:function(e){return this.cache[e.id]&&(!0===this.cache[e.id].use||this.cache[e.id].parent)}},{key:"getCache",value:function(e){var t=this.cache[e.id];return t.use=!0,t.vnode}},{key:"initOrgChildren",value:function(){var e=this.$handle.parsers;this.orgChildren=Object.keys(e).reduce(function(t,r){var n=e[r].rule.children;return t[r]=isValidChildren(n)?_toConsumableArray(n):[],t},{})}},{key:"run",value:function(){var e=this;if(this.vm.isShow){this.$form.beforeRender();var t=this.$handle.sortList.map(function(t){var r=e.$handle.parsers[t];if("hidden"!==r.type)return e.renderParser(r)}).filter(function(e){return void 0!==e});return this.$form.render(t)}}},{key:"setGlobalConfig",value:function(e){this.options.global&&(this.options.global["*"]&&this.toData(e,this.options.global["*"]),this.options.global[e.type]&&this.toData(e,this.options.global[e.type]))}},{key:"renderTemplate",value:function(e){var t=this,r=e.id,n=e.rule,i=e.key;if(void 0===_vue.compile)return console.error("使用的 Vue 版本不支持 compile"+errMsg()),[];this.renderList[r]||(isUndef(n.vm)&&(n.vm=new _vue),this.renderList[r]=_vue.compile(n.template)),setTemplateProps(e),n.vm.$off("input"),n.vm.$on("input",function(r){t.onInput(e,r)});var a=this.renderList[r].render.call(n.vm);return void 0===a.data&&(a.data={}),a.key=i,a}},{key:"renderParser",value:function(e,t){if(e.vData.get(),this.setGlobalConfig(e),!this.cache[e.id]||"template"===e.type){var r,n=e.type,i=e.rule,a=this.$form;if("template"===n&&i.template){if(r=this.renderTemplate(e),t)return this.setCache(e,r,t),r}else if(this.$handle.isNoVal(e)){if(r=this.vNode.make(n,this.inputVData(e),this.renderChildren(e)),t)return this.setCache(e,r,t),r}else{var o=this.renderChildren(e);r=e.render?e.render(o):this.defaultRender(e,o)}return!0!==i.native&&(r=a.container(r,e)),this.setCache(e,r,t),r}return this.getCache(e)}},{key:"toData",value:function(e,t){return Object.keys(e.vData._data).forEach(function(r){void 0!==t[r]&&e.vData[r](t[r])}),e.vData}},{key:"parserToData",value:function(e){return this.toData(e,e.rule)}},{key:"inputVData",value:function(e,t){var r=this,n=e.refName,i=e.key;this.parserToData(e);var a=e.vData.ref(n).key("fc_item"+i);return t||a.on("input",function(t){r.onInput(e,t)}).props("value",this.$handle.getFormData(e)),this.$form.inputVData&&this.$form.inputVData(e,t),a}},{key:"onInput",value:function(e,t){this.$handle.onInput(e,t)}},{key:"renderChildren",value:function(e){var t=this,r=e.rule.children,n=this.orgChildren[e.id];return isValidChildren(r)?(this.orgChildren[e.id].forEach(function(e){-1===r.indexOf(e)&&!isString(e)&&e.__fc__&&t.$handle.removeField(e.__fc__)}),r.map(function(r){return isString(r)?r:r.__fc__?t.renderParser(r.__fc__,e):void $de(function(){return t.$handle.reloadRule()})})):(n.forEach(function(e){!isString(e)&&e.__fc__&&t.$handle.removeField(e.__fc__)}),this.orgChildren[e.id]=[],[])}},{key:"defaultRender",value:function(e,t){return this.vNode[e.type]?this.vNode[e.type](this.inputVData(e),t):this.vNode.make(e.type,this.inputVData(e),t)}}]),e}();function setTemplateProps(e){var t=e.rule;if(t.vm.$props){var r=Object.keys(t.vm.$props);r.forEach(function(e){void 0!==t.props[e]&&(t.vm.$props[e]=t.props[e])}),-1!==r.indexOf("value")&&(t.vm.$props.value=e.rule.value)}}function getRule(e){return isFunction(e.getRule)?e.getRule():e}var Handle=function(){function e(t){_classCallCheck(this,e);var r=t.vm,n=t.rules,i=t.options;this.vm=r,this.fc=t,this.id=uniqueId(),this.options=i,this.validate={},this.formData={},this.fCreateApi=void 0,this.__init(n),this.$form=new t.drive.formRender(this,this.id),this.$render=new Render(this),this.loadRule(this.rules,!1),this.$render.initOrgChildren(),this.$form.init()}return _createClass(e,[{key:"__init",value:function(e){this.fieldList={},this.trueData={},this.parsers={},this.customData={},this.sortList=[],this.rules=e,this.origin=_toConsumableArray(this.rules),this.changeStatus=!1}},{key:"loadRule",value:function(e,t){var r=this;e.map(function(e){if(!t||!isString(e)){if(!e.type)return console.error("未定义生成规则的 type 字段"+errMsg());var n;if(e.__fc__){if((n=e.__fc__).vm!==r.vm&&!n.deleted)return console.error("".concat(e.type,"规则正在其他的 <form-create> 中使用")+errMsg());n.update(r)}else n=r.createParser(r.parseRule(e));var i=n.rule.children,a=n.rule;return r.notField(n.field)?(r.setParser(n),e.__fc__||bindParser(e,n),isValidChildren(i)&&r.loadRule(i,!0),t||r.sortList.push(n.id),r.isNoVal(n)||Object.defineProperty(n.rule,"value",{get:function(){return n.toValue(r.getFormData(n))},set:function(e){r.isChange(n,e)&&(r.$render.clearCache(n,!0),r.setFormData(n,n.toFormValue(e)))}}),n):console.error("".concat(a.field," 字段已存在")+errMsg())}}).filter(function(e){return e}).forEach(function(t){t.root=e})}},{key:"createParser",value:function(e){var t=this.id+""+uniqueId(),r=this.fc.parsers,n=toString(e.type).toLocaleLowerCase();return new(r[n]?r[n]:BaseParser)(this,e,t)}},{key:"parseRule",value:function(e){var t=defRule(),r=getRule(e);Object.keys(t).forEach(function(e){isUndef(r[e])&&$set(r,e,t[e])});var n={options:parseArray(r.options)};return n.on=this.parseOn(r.on||{},this.parseEmit(r)),Object.keys(n).forEach(function(e){$set(r,e,n[e])}),r}},{key:"parseOn",value:function(e,t){var r=this;return this.options.injectEvent&&Object.keys(e).forEach(function(t){e[t]=r.inject(e[t])}),_parseOn(e,t)}},{key:"inject",value:function(e,t){e.__inject&&(e=e.__origin);var r=this,n=function(){for(var n=r.vm.$options.propsData,i=n.option,a=n.rule,o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];s.unshift({$f:r.fCreateApi,rule:a,option:i,inject:t}),e.apply(this,s)};return n.__inject=!0,n.__origin=e,n}},{key:"parseEmit",value:function(e){var t=this,r={},n=e.emit,i=e.emitPrefix,a=e.field;return Array.isArray(n)?(n.forEach(function(e){var n={},o=e;if(isPlainObject(e)&&(o=e.name,n=e.inject||{}),o){var s=toLine("".concat(i||a,"-").concat(o)).replace("_","-"),u=function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(e=t.vm).$emit.apply(e,[s].concat(n))};u.__emit=!0,r[o]=t.options.injectEvent||void 0!==e.inject?t.inject(u,n):u}}),r):r}},{key:"run",value:function(){return this.vm.unique>0?this.$render.run():(this.vm.unique=1,[])}},{key:"setParser",value:function(e){var t=e.id,r=e.field,n=e.name,i=e.rule;this.parsers[t]||(this.parsers[t]=e,this.isNoVal(e)?n&&$set(this.customData,n,e):(this.fieldList[r]=e,$set(this.formData,r,e.toFormValue(i.value)),$set(this.validate,r,i.validate||[]),$set(this.trueData,r,e)))}},{key:"notField",value:function(e){return void 0===this.parsers[e]}},{key:"isChange",value:function(e,t){return JSON.stringify(e.rule.value)!==JSON.stringify(t)}},{key:"onInput",value:function(e,t){!this.isNoVal(e)&&this.isChange(e,e.toValue(t))&&(this.$render.clearCache(e),this.setFormData(e,t),this.changeStatus=!0)}},{key:"getParser",value:function(e){return this.fieldList[e]?this.fieldList[e]:this.customData[e]?this.customData[e]:this.parsers[e]?this.parsers[e]:void 0}},{key:"created",value:function(){var e=this.vm;e.$set(e,"buttonProps",this.options.submitBtn),e.$set(e,"resetProps",this.options.resetBtn),e.$set(e,"formData",this.formData),void 0===this.fCreateApi&&(this.fCreateApi=this.fc.drive.getGlobalApi(this)),this.fCreateApi.rule=this.rules,this.fCreateApi.config=this.options}},{key:"addParserWitch",value:function(e){var t=this,r=this.vm;Object.keys(e.rule).forEach(function(n){-1===["field","type","value","vm","template","name","config"].indexOf(n)&&void 0!==e.rule[n]&&e.watch.push(r.$watch(function(){return e.rule[n]},function(r,n){void 0!==n&&t.$render.clearCache(e)},{deep:!0,immediate:!0}))})}},{key:"mountedParser",value:function(){var e=this,t=this.vm;Object.keys(this.parsers).forEach(function(r){var n=e.parsers[r];0===n.watch.length&&e.addParserWitch(n),n.el=t.$refs[n.refName]||{},void 0===n.defaultValue&&(n.defaultValue=deepExtend({},{value:n.rule.value}).value),n.mounted&&n.mounted()})}},{key:"mounted",value:function(){var e=this.options.mounted;this.mountedParser(),e&&e(this.fCreateApi),this.fc.$emit("mounted",this.fCreateApi)}},{key:"reload",value:function(){var e=this.options.onReload;this.mountedParser(),e&&e(this.fCreateApi),this.fc.$emit("on-reload",this.fCreateApi)}},{key:"removeField",value:function(e){var t=e.id,r=e.field,n=this.sortList.indexOf(t);delParser(e),$del(this.parsers,t),-1!==n&&this.sortList.splice(n,1),this.fieldList[r]||($del(this.validate,r),$del(this.formData,r),$del(this.customData,r),$del(this.fieldList,r),$del(this.trueData,r))}},{key:"refresh",value:function(){this.vm._refresh()}},{key:"reloadRule",value:function(e){var t=this,r=this.vm;if(!e)return this.reloadRule(this.rules);this.origin.length||this.fCreateApi.refresh(),this.origin=_toConsumableArray(e);var n=_objectSpread({},this.parsers);this.__init(e),this.loadRule(e,!1),Object.keys(n).filter(function(e){return void 0===t.parsers[e]}).forEach(function(e){return t.removeField(n[e])}),this.$render.initOrgChildren(),this.created(),r.$nextTick(function(){t.reload()}),r.$f=this.fCreateApi,this.$render.clearCacheAll(),this.refresh()}},{key:"setFormData",value:function(e,t){this.formData[e.field]=t}},{key:"getFormData",value:function(e){return this.formData[e.field]}},{key:"fields",value:function(){return Object.keys(this.formData)}},{key:"isNoVal",value:function(e){return!e.isDef}}]),e}();function delParser(e){e.watch.forEach(function(e){return e()}),e.watch=[],e.deleted=!0,Object.defineProperty(e.rule,"value",{value:extend({},{value:e.rule.value}).value})}function _parseOn(e,t){return Object.keys(t).length>0&&extend(e,t),e}function parseArray(e){return Array.isArray(e)?e:[]}function defRule(){return{validate:[],col:{},emit:[],props:{},on:{},options:[],title:void 0,value:"",field:"",name:void 0,className:void 0}}function bindParser(e,t){Object.defineProperties(e,{__field__:{value:t.field,enumerable:!1,configurable:!1},__fc__:{value:t,enumerable:!1,configurable:!1}})}var _vue="undefined"!=typeof window&&window.Vue?window.Vue:Vue;function createFormCreate(e){var t={},r={},n=makerFactory(),i=e.getConfig(),a={};function o(e,t){e=toString(e),r[e.toLocaleLowerCase()]=t,d.maker[e]=creatorFactory(e)}function s(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,BaseParser),t}()}function u(e,r){var n=(e=toString(e)).toLocaleLowerCase();return"form-create"===n||"formcreate"===n?l():void 0===r?t[e]:void(t[e]=r)}function c(e,t){isBool(t.sumbitBtn)&&(t.sumbitBtn={show:t.sumbitBtn}),isBool(t.resetBtn)&&(t.resetBtn={show:t.resetBtn});var r=deepExtend(e,t);return $set(r,"el",r.el?isElement(r.el)?r.el:document.querySelector(r.el):window.document.body),r}function l(){return _vue.extend($FormCreate(d,t))}function f(t){extend(t,{version:e.version,ui:e.ui,maker:n,component:u,setParser:o,createParser:s,data:a,$form:function(){return l()},parseJson:function(e){return parseJson(e)}})}function h(e,t){var r=new _vue({data:function(){return{rule:e,option:isElement(t)?{el:t}:t}},render:function(){return(0,arguments[0])("form-create",_mergeJSXProps([{ref:"fc"},{props:this.$data}]))}});return r.$mount(),r}var d=function(){function t(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.fCreateApi=void 0,this.drive=e,this.parsers=r,this.vm=void 0,this.rules=Array.isArray(n)?n:[],this.options=c(deepExtend({},i),a)}return _createClass(t,[{key:"beforeCreate",value:function(e){this.vm=e,this.handle=new Handle(this)}},{key:"created",value:function(){this.handle.created()}},{key:"api",value:function(){return this.handle.fCreateApi}},{key:"render",value:function(){return this.handle.run()}},{key:"mounted",value:function(){this.handle.mounted()}},{key:"$emit",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this.$parent&&(t=this.$parent).$emit.apply(t,["fc:".concat(e)].concat(i)),(r=this.vm).$emit.apply(r,[e].concat(i))}}],[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=h(e,t),i=n.$refs.fc.formCreate;return i.parent=r,i.options.el.appendChild(n.$el),i.handle.fCreateApi}},{key:"install",value:function(e){var r=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.create(e,r,this)};f(r),e.prototype.$formCreate=r,e.component(formCreateName,l()),_vue=e}},{key:"init",value:function(e){var t=h(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),r=t.$refs.fc.formCreate;return{mount:function(e){return e&&isElement(e)&&(r.options.el=e),r.options.el.appendChild(t.$el),r.handle.fCreateApi},remove:function(){r.options.el.removeChild(t.$el)},destroy:function(){this.remove(),t.$destroy()},$f:r.handle.fCreateApi}}}]),t}();return f(d),e.components.forEach(function(e){d.component(e.name,e)}),e.parsers.forEach(function(e){var t=e.name,r=e.parser;d.setParser(t,r)}),Object.keys(e.makers).forEach(function(t){d.maker[t]=e.makers[t]}),{FormCreate:d,install:function(e,t){!0!==e._installedFormCreate&&(e._installedFormCreate=!0,t&&isPlainObject(t)&&c(i,t),e.use(d))}}}var BaseForm=function(){function e(t){_classCallCheck(this,e),this.$handle=t,this.vm=t.vm,this.drive=this.$handle.fc.drive,this.options=t.options,this.vNode=new VNode(this.vm),this.vData=new VData,this.unique=t.id}return _createClass(e,[{key:"init",value:function(){this.$render=this.$handle.$render}},{key:"getGetCol",value:function(e){var t=e.rule.col||{},r={},n={};return this.options.global?(this.options.global["*"]&&(r=this.options.global["*"].col||{}),this.options.global[e.type]&&(n=this.options.global[e.type].col||{}),t=deepExtend(deepExtend(deepExtend({},r),n),t)):t}},{key:"beforeRender",value:function(){}},{key:"render",value:function(){}},{key:"inputVData",value:function(){}}]),e}();export default createFormCreate;export{BaseForm,BaseParser,Creator,Handle,Render,VData,VNode,_vue as Vue,creatorFactory,creatorTypeFactory,makerFactory,parseJson,toJson};
//# sourceMappingURL=form-create.core.min.js.map
